"use strict";(()=>{var r=class{constructor(e){this.ttl=e,this.pdfIdQueue=new Set,this.pdfData=new Map}push(e,s){this.pdfData.set(e,s),this.pdfIdQueue.add(e),setTimeout(()=>{this.pdfIdQueue.delete(e),this.pdfData.delete(e)},this.ttl)}shiftId(){let e=null;return this.pdfIdQueue.size>=1&&(e=this.pdfIdQueue.values().next().value,this.pdfIdQueue.delete(e)),e}get(e){var s;return(s=this.pdfData.get(e))!=null?s:null}};var i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",c=()=>{let t=Math.floor(Math.random()*i.length);return i[t]},u=t=>{let e="";for(let s=0;s<t;s++)e+=c();return e},o=u;chrome.action.onClicked.addListener(t=>{chrome.scripting.executeScript({target:{tabId:t.id},files:["main.js"]})});chrome.runtime.onMessageExternal.addListener(t=>{n(e=>{chrome.tabs.sendMessage(e,{message:t})})});chrome.commands.onCommand.addListener(t=>{switch(t){case"scroll_up":n(e=>chrome.tabs.sendMessage(e,{message:{type:"scroll_up"}}));break;case"scroll_down":n(e=>chrome.tabs.sendMessage(e,{message:{type:"scroll_down"}}));break;case"activate_extension":n(e=>chrome.scripting.executeScript({target:{tabId:e},files:["main.js"]}));break}});var d=new r(1e3*30);chrome.runtime.onMessage.addListener((t,e,s)=>{switch(t==null?void 0:t.type){case"open_pdf":{let a=o(32);d.push(a,t.payload),chrome.runtime.sendMessage({type:"prepare_pdf"}),chrome.runtime.openOptionsPage(()=>{s()});break}case"shift_pdf_id":{let a=d.shiftId();s(a);break}case"get_pdf_data":{let a=d.get(t.id);s(a);break}}});var n=t=>{chrome.tabs.query({active:!0,currentWindow:!0},e=>{for(let s=0;s<e.length;s++)t(e[s].id)})};})();
